"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.KafkaMessageControl = void 0;
class KafkaMessageControl {
    consumer;
    topic;
    partition;
    offset;
    constructor(consumer, topic, partition, offset) {
        this.consumer = consumer;
        this.topic = topic;
        this.partition = partition;
        this.offset = offset;
    }
    async ack() {
        await this.consumer.commitOffsets([
            {
                topic: this.topic,
                partition: this.partition,
                offset: (BigInt(this.offset) + BigInt(1)).toString(),
            },
        ]);
    }
    async nack(error) {
        console.warn(`Kafka nack: ${error?.message || "unknown error"}`);
    }
}
exports.KafkaMessageControl = KafkaMessageControl;
//# sourceMappingURL=KafkaMessageControl.js.map